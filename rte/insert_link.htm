<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
	<title>创建链接</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script language="JavaScript" type="text/javascript">
<!--
var ua = navigator.userAgent.toLowerCase();
var isIE = ((ua.indexOf("msie") != -1) && (ua.indexOf("opera") == -1) && (ua.indexOf("webtv") == -1));
var ieVersion = parseFloat( ua.substring( ua.indexOf('msie ') + 5 ) );
var isGecko = (ua.indexOf("gecko") != -1);
var isSafari = (ua.indexOf("safari") != -1);
var safariVersion = parseFloat(ua.substring(ua.lastIndexOf("safari/") + 7));
var isKonqueror = (ua.indexOf("konqueror") != -1);
var isOpera = (ua.indexOf("opera") != -1);
var isNetscape = (ua.indexOf("netscape") != -1);

function getQueryVariable(variable) {
	try {
		var query = window.location.search.substring(1);
		var vars = query.split("&");
		for (var i=0; i < vars.length; i++) {
			var pair = vars[i].split("=");
			if (pair[0] == variable) {
				return unescape(pair[1]);
			}
		}
	} catch (e) {
		alert(e);
	}
}

function AddLink() {
	try {
		var oForm = document.linkForm;
		
		//validate form
		if (oForm.url.value == '') {
			alert('请输入链接地址.');
			return false;
		}
		if (oForm.linkText.value == '') {
			alert('请输入内容.');
			return false;
		}
		
		var html = '<a href="' + document.linkForm.url.value + '" target="' + document.linkForm.linkTarget.options[document.linkForm.linkTarget.selectedIndex].value + '">' + document.linkForm.linkText.value + '</a>';
		
		opener.insertHTML(html);
		window.close();
		return true;
	} catch (e) {
		alert(e);
	}
}

function setLinkText(linkText) {
	//set link text value in insert link dialog
	try {
		document.linkForm.linkText.value = linkText;
	} catch (e) {
		//may take some time to create dialog window.
		//Keep looping until able to set.
		//alert(e);
		setInterval("setLinkText('" + linkText + "')", 100);
	}
}
//-->
</script>
</head>

<body style="margin: 10px; background: #D3D3D3;">

<form name="linkForm" onSubmit="return AddLink();">
<table align="center" cellpadding="4" cellspacing="0" border="0">
	<tr><td colspan="2"><span style="font-style: italic; font-size: x-small;"><b>提示:</b> 输入邮件地址时, 请在地址前加上 "mailto:"</span></td></tr>
	<tr>
		<td align="right">链接地址:</td>
		<td><input name="url" type="text" id="url" size="34"></td>
	</tr>
	<tr>
		<td align="right">内容:</td>
		<td><input name="linkText" type="text" id="linkText" size="34"></td>
	</tr>
	<tr>
		<td align="right">打开方式:</td>
		<td align="left">
			<select name="linkTarget" id="linkTarget">
				<option value="_blank">_blank</option>
				<option value="_parent">_parent</option>
				<option value="_self" selected>_self</option>
				<option value="_top">_top</option>
			</select>
		</td>
	</tr>
	<tr>
		<td colspan="3" align="center">
			<input type="submit" style="WIDTH: 70px" value="插 入" />&nbsp;&nbsp;&nbsp;
			<input type="button" style="WIDTH: 70px" value="取 消" onClick="window.close();" />
		</td>
	</tr>
</table>

</form>
<script language="JavaScript" type="text/javascript">
<!--
setLinkText(getQueryVariable("selectionText"));
//-->
</script>
</body>
</html>
